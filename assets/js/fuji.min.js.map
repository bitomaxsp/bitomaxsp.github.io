{"version":3,"sources":["fuji.js"],"names":["getNowTheme","nowTheme","document","body","getAttribute","window","matchMedia","matches","updateMeidumTheme","mediumInst","targetTheme","detach","mediumZoom","background","updateUtterancesTheme","utterancesFrame","contentWindow","postMessage","type","theme","querySelector","addEventListener","loadComment","documentElement","scrollTop","domTheme","systemTheme","setAttribute","localStorage","setItem","commentArea","DISQUS","reset","reload"],"mappings":"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","sourcesContent":["'use strict';\r\n\r\n// get current theme\r\nfunction getNowTheme() {\r\n    let nowTheme = document.body.getAttribute('data-theme');\r\n    if (nowTheme === 'auto') {\r\n        return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';\r\n    } else {\r\n        return nowTheme === 'dark' ? 'dark' : 'light';\r\n    }\r\n}\r\n\r\n// update medium-zoom theme\r\nfunction updateMeidumTheme(mediumInst) {\r\n    let targetTheme = getNowTheme();\r\n    if (mediumInst) {\r\n        mediumInst.detach();\r\n        if (targetTheme === 'dark') {\r\n            mediumInst = mediumZoom('.img-zoomable', {\r\n                background: '#2f3136',\r\n            });\r\n        } else {\r\n            mediumInst = mediumZoom('.img-zoomable', {\r\n                background: '#fffffd',\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\n// update utterances theme\r\nfunction updateUtterancesTheme(utterancesFrame) {\r\n    let targetTheme = getNowTheme();\r\n    if (utterancesFrame) {\r\n        if (targetTheme === 'dark') {\r\n            utterancesFrame.contentWindow.postMessage(\r\n                {\r\n                    type: 'set-theme',\r\n                    theme: 'photon-dark',\r\n                },\r\n                'https://utteranc.es'\r\n            );\r\n        } else {\r\n            utterancesFrame.contentWindow.postMessage(\r\n                {\r\n                    type: 'set-theme',\r\n                    theme: 'github-light',\r\n                },\r\n                'https://utteranc.es'\r\n            );\r\n        }\r\n    }\r\n}\r\n\r\n// load comment button only when comment area exist\r\nif (document.querySelector('span.post-comment-notloaded')) {\r\n    document.querySelector('span.post-comment-notloaded').addEventListener('click', loadComment);\r\n}\r\n\r\n// to-top button\r\ndocument.querySelector('.btn .btn-scroll-top').addEventListener('click', () => {\r\n    document.documentElement.scrollTop = 0;\r\n});\r\n\r\n// init medium-zoom\r\nvar mediumInst; // medium-zoom instance\r\nif (getNowTheme() === 'dark') {\r\n    mediumInst = mediumZoom('.img-zoomable', {\r\n        background: '#2f3136',\r\n    });\r\n} else {\r\n    mediumInst = mediumZoom('.img-zoomable', {\r\n        background: '#fffffd',\r\n    });\r\n}\r\n\r\n// theme switch button\r\ndocument.querySelector('.btn .btn-toggle-mode').addEventListener('click', () => {\r\n    let nowTheme = getNowTheme();\r\n    let domTheme = document.body.getAttribute('data-theme');\r\n    let systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';\r\n\r\n    if (domTheme === 'auto') {\r\n        // if now in auto mode, switch to user mode\r\n        document.body.setAttribute('data-theme', nowTheme === 'light' ? 'dark' : 'light');\r\n        localStorage.setItem('fuji_data-theme', nowTheme === 'light' ? 'dark' : 'light');\r\n    } else if (domTheme === 'light') {\r\n        // if now in user mode and light mode\r\n        document.body.setAttribute('data-theme', 'dark');\r\n        // if the theme want to switch is system theme\r\n        localStorage.setItem('fuji_data-theme', systemTheme === 'dark' ? 'auto' : 'dark');\r\n    } else {\r\n        // if now in user mode and dark mode\r\n        document.body.setAttribute('data-theme', 'light');\r\n        // if the theme want to switch is system theme\r\n        localStorage.setItem('fuji_data-theme', systemTheme === 'light' ? 'auto' : 'light');\r\n    }\r\n\r\n    // update medium background\r\n    updateMeidumTheme(mediumInst);\r\n    // switch comment area theme\r\n    // if this page has comment area\r\n    let commentArea = document.querySelector('.post-comment');\r\n    if (commentArea) {\r\n        // if comment area loaded\r\n        if (document.querySelector('span.post-comment-notloaded').getAttribute('style')) {\r\n            if (commentArea.getAttribute('data-comment') === 'utterances') {\r\n                updateUtterancesTheme(document.querySelector('.post-comment iframe'));\r\n            }\r\n            if (commentArea.getAttribute('data-comment') === 'disqus') {\r\n                DISQUS.reset({\r\n                    reload: true,\r\n                });\r\n            }\r\n        }\r\n    }\r\n});\r\n"],"file":"fuji.min.js"}